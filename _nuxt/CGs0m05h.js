import{u as S,_ as B}from"./C-hzkbBh.js";import{g as V,r as d,c as i,o as r,a,v as e,B as E,C as j,s as T,q as y,p as k,b as w,w as h,F as C,D as U,d as $,E as I}from"./ClqIKUm5.js";import{_ as L}from"./tmR5c10u.js";import{_ as M,S as N,a as R}from"./hbFxgJu-.js";import{_ as z}from"./9DMz08vQ.js";/* empty css        */const D={class:"relative"},F=["src"],q=["disabled"],A={key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},G={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},P={key:2,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},J=V({__name:"index",props:{index:{},src:{},masterpiece:{}},setup(x){const n=x,l=d(!1),m=d(!1),u=s=>{n.masterpiece&&n.masterpiece.splice(s,1)},p=async()=>{if(!l.value){l.value=!0,m.value=!1;try{const s=await fetch(`/api/image?url=${encodeURIComponent(n.src)}`);if(!s.ok)throw new Error(`Failed to fetch image, Status: ${s.status}`);const t=s.headers.get("Content-Type");if(!t||!t.includes("image/png"))throw new Error("The server did not return a valid PNG image");const g=await s.blob(),v=window.URL.createObjectURL(g),c=document.createElement("a");c.href=v,c.download=`masterpiece_${Date.now()}.png`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(v)}catch(s){console.error("Failed to download image:",s)}finally{l.value=!1}}};return(s,t)=>(r(),i("div",D,[a("img",{src:n.src,alt:"Masterpiece Image",class:"w-full h-auto",onError:t[0]||(t[0]=g=>u(n.index))},null,40,F),a("button",{onClick:j(p,["stop"]),class:E(["absolute bottom-2 right-2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70 focus:outline-none",{"opacity-50 cursor-wait":e(l),"bg-green-500 bg-opacity-70":e(m)}]),disabled:e(l),title:"Save as PNG"},[e(l)?(r(),i("svg",A,t[1]||(t[1]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):e(m)?(r(),i("svg",G,t[2]||(t[2]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(r(),i("svg",P,t[3]||(t[3]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"},null,-1)])))],10,q)]))}}),O={class:"bg-white h-screen w-full flex flex-col justify-between px-4 md:px-8"},H={class:"flex flex-col justify-center items-center flex-grow text-center"},K={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"},W=["onClick"],oe=V({__name:"index",setup(x){const n=S(),{masterpieces:l}=T(n),m=d(0),u=d(!1),p=d(null),s=d(null),t=d({username:"",game:"flash"}),g=({username:f,game:o})=>(l.value=[],n.fetchMasterpieces({username:f,game:o}).then(async()=>{await I(),t.value={username:"",game:o},m.value++,l.value.length>0&&s.value&&s.value.scrollIntoView({behavior:"smooth"})})),v=f=>{p.value=f,u.value=!0,n.saveMasterpiece(f)},c=()=>{p.value=null,u.value=!1};return(f,o)=>(r(),i(C,null,[a("header",O,[a("div",H,[w(e(z),{color:"black",icon:"info-circle",class:"mb-10"},{default:h(()=>o[0]||(o[0]=[$(" This site is still in development and may not work as expected. ")])),_:1,__:[0]}),o[3]||(o[3]=a("h1",{class:"text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-blue-500 mb-4 animate-gradient"}," Animal Jam Masterpieces Viewer ",-1)),o[4]||(o[4]=a("p",{class:"text-sm md:text-md text-gray-700 mb-4 md:mb-8"}," Discover the amazing masterpieces from the Animal Jam community! ",-1)),(r(),k(e(R),{key:e(m),"initial-values":e(t),"validation-schema":e(N),onSubmit:g,class:"flex flex-col md:flex-row justify-center items-center mb-8 space-y-4 md:space-y-0 md:space-x-4"},{default:h(()=>[w(e(M),{label:"Username",name:"username",type:"text",placeholder:"Enter Username",icon:"paw",class:"md:w-auto",required:""}),w(e(M),{label:"Game",name:"game",type:"select",placeholder:"",icon:"gamepad",class:"md:w-auto",required:""},{default:h(()=>o[1]||(o[1]=[a("option",{value:"flash"},"Classic",-1),a("option",{value:"mobile"},"Play Wild",-1)])),_:1,__:[1]}),w(e(L),{type:"submit",variant:"primary",size:"md",class:"md:w-auto"},{default:h(()=>o[2]||(o[2]=[$(" View Masterpieces ")])),_:1,__:[2]})]),_:1},8,["initial-values","validation-schema"]))])]),e(l).length?(r(),i("section",{key:0,ref_key:"masterpiecesSection",ref:s,class:"p-4 bg-black"},[a("div",K,[(r(!0),i(C,null,U(e(l),(_,b)=>(r(),i("div",{key:b,class:"bg-white rounded-lg shadow-lg overflow-hidden transition-transform transform hover:scale-105 cursor-pointer",onClick:Q=>v(_)},[w(e(J),{src:_,index:b,masterpiece:e(l)},null,8,["src","index","masterpiece"])],8,W))),128))])],512)):y("",!0),e(u)?(r(),k(e(B),{key:1,image:e(p),onClose:c},null,8,["image"])):y("",!0)],64))}});export{oe as default};
