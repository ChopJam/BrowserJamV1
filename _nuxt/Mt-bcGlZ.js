import{y as T,z as j,r as x,g as Q,s as S,c as p,a as n,b as u,q as $,w as h,v as l,F as N,D as R,o as g,d as y,C as k,t as C}from"./ClqIKUm5.js";import{_ as F}from"./tmR5c10u.js";import{_ as V,M as A,a as L}from"./hbFxgJu-.js";import{_ as U}from"./9DMz08vQ.js";const q=T("uploader",()=>{const{$toast:v}=j(),s=x([]),d=x(""),f=a=>{d.value=a},m=a=>{s.value.push({name:a.name,file:a,status:"Queued"})},w=async()=>{if(s.value.length===0){v.error("No files in the queue to process.",{toastStyle:{background:"black",color:"white"}});return}for(const a of s.value)await b(a.file),await new Promise(c=>setTimeout(c,2e3))},_=a=>{s.value.splice(a,1)},b=async a=>{const c=new FormData;c.append("masterpiece",a),c.append("username",d.value);const t=await fetch("https://api.jam.exposed/v1/masterpiece/create",{method:"POST",body:c}),e=s.value.findIndex(D=>D.file===a);if(e!==-1&&(s.value[e].status=t.ok?"Completed":"Failed"),!t.ok){v.error("Error uploading file.",{toastStyle:{background:"black",color:"white"}});return}const o=await t.blob(),i=window.URL.createObjectURL(o),r=document.createElement("a");r.href=i,r.download=`masterpiece-${Date.now()}.ajart`,document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(i)};return{files:s,username:d,setUsername:f,addFileToQueue:m,processQueue:w,removeFile:_}}),E={class:"flex flex-col min-h-screen"},I={class:"flex-grow flex items-center justify-center"},M={class:"max-w-md w-full p-8 bg-white shadow-lg rounded-lg"},z={class:"mt-5 mb-4"},B={key:0,class:"mt-4 overflow-x-auto"},O={class:"flex flex-col space-y-4"},P={class:"flex items-center space-x-4 flex-grow"},Y={class:"text-sm font-semibold text-gray-700"},W=Q({__name:"masterpiece",setup(v){const s=q(),{files:d}=S(s),f=x(null),m={username:"",files:[]},w=t=>{s.setUsername(t.username),s.processQueue()},_=t=>{var o,i;const e=(o=t.dataTransfer)==null?void 0:o.files;if(e){m.files=Array.from((i=t.dataTransfer)==null?void 0:i.files);for(let r=0;r<e.length;r++)s.addFileToQueue(e[r])}},b=()=>{const t=f.value;t&&t.click()},a=t=>{const e=t.target;if(e.files){m.files=Array.from(e.files);for(let o=0;o<e.files.length;o++)s.addFileToQueue(e.files[o])}},c=t=>{switch(t){case"Completed":return"green";case"Queued":return"black";case"Failed":return"red";default:return"yellow"}};return(t,e)=>(g(),p("div",E,[n("main",I,[n("div",M,[e[4]||(e[4]=n("h2",{class:"text-2xl font-bold mb-4 text-center"},"Upload Your Image Files",-1)),u(l(U),{color:"black",icon:"info-circle"},{default:h(()=>e[1]||(e[1]=[y(" Using this tool, you can upload any image file you have and view them in Animal Jam Classic! ")])),_:1,__:[1]}),u(l(L),{"initial-values":m,"validation-schema":l(A),onSubmit:w},{default:h(()=>[n("div",z,[u(l(V),{label:"Username",name:"username",type:"text",placeholder:"Enter Your Username",icon:"paw",required:""})]),n("div",{onDrop:k(_,["prevent"]),onDragover:e[0]||(e[0]=k(()=>{},["prevent"])),class:"border-2 border-dashed border-gray-400 rounded-lg p-6 text-center cursor-pointer transition hover:bg-gray-100",onClick:b,name:"files",label:"Files"},[e[2]||(e[2]=n("p",{class:"text-gray-600"},"Drag & Drop your files here or click to upload",-1)),n("input",{type:"file",ref_key:"fileInput",ref:f,onChange:a,class:"hidden",multiple:""},null,544)],32),u(l(F),{type:"submit",variant:"primary",size:"md",class:"mt-4 w-full"},{default:h(()=>e[3]||(e[3]=[y(" Convert All To Masterpieces ")])),_:1,__:[3]})]),_:1},8,["validation-schema"]),l(d).length?(g(),p("div",B,[n("div",O,[(g(!0),p(N,null,R(l(d),(o,i)=>(g(),p("div",{key:i,class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg shadow-sm hover:bg-gray-100 transition"},[n("div",P,[n("p",Y,C(o.name),1),u(l(U),{color:c(o.status),icon:"check-circle",class:"ml-2"},{default:h(()=>[y(C(o.status),1)]),_:2},1032,["color"])]),u(l(F),{variant:"secondary",size:"xs",icon:"trash",class:"w-6 h-6 bg-red-100 hover:bg-red-200 text-red-600 rounded-full flex items-center justify-center transition duration-20 md:w-auto md:h-auto",onClick:r=>l(s).removeFile(i)},null,8,["onClick"])]))),128))])])):$("",!0)])])]))}});export{W as default};
